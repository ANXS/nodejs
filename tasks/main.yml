# file: nodejs/tasks/main.yml

- include: package.yml
  when: nodejs_install_method == "package"

- name: node.js | Check if the node version is already installed
  shell: if hash node 2> /dev/null; then echo $(node --version); fi
  ignore_errors: yes
  register: node_version
  changed_when: node_version.rc != 0 or node_version.stdout != "v{{ nodejs_version }}"
  when: nodejs_install_method == "source" or nodejs_install_method == "binary"

- include: source.yml
  when: nodejs_install_method == "source" and node_version.changed

- include: binary.yml
  when: nodejs_install_method == "binary" and node_version.changed
